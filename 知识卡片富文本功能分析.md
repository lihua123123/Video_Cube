# çŸ¥è¯†å¡ç‰‡å¯Œæ–‡æœ¬åŠŸèƒ½åˆ†ææŠ¥å‘Š

## ğŸ“Š åŠŸèƒ½éœ€æ±‚åˆ†æ

### è¦æ±‚çš„åŠŸèƒ½
çŸ¥è¯†å¡ç‰‡éœ€è¦æ”¯æŒ**å¯Œæ–‡æœ¬å†…å®¹**,åŒ…æ‹¬:
1. âœ… æ–‡å­—(å·²å®ç°)
2. âœ… å›¾ç‰‡(å·²å®ç°)
3. âœ… è¶…é“¾æ¥(å·²å®ç°)
4. âŒ **æ›´ä¸°å¯Œçš„æ ¼å¼**(éœ€å¢å¼º)

## âœ… å·²å®ç°çš„åŠŸèƒ½

### 1. åŸºç¡€å¯Œæ–‡æœ¬æ”¯æŒ

**KnowledgeCardPopup.vue - formatContentå‡½æ•°:**
```typescript
const formatContent = (content?: string): string => {
  if (!content) return '';
  
  let formatted = content;
  
  // âœ… å›¾ç‰‡æ ‡ç­¾å¤„ç†
  formatted = formatted.replace(/<img/g, '<img style="max-width: 100%; height: auto; border-radius: 8px; margin: 8px 0;"');
  
  // âœ… é“¾æ¥æ ‡ç­¾å¤„ç†
  formatted = formatted.replace(/<a/g, '<a target="_blank" rel="noopener noreferrer"');
  
  return formatted;
};
```

**é—®é¢˜:**
- âš ï¸ åŠŸèƒ½è¿‡äºç®€å•
- âš ï¸ ä¸æ”¯æŒMarkdownæ ¼å¼
- âš ï¸ æ²¡æœ‰ä»£ç é«˜äº®
- âš ï¸ æ²¡æœ‰è§†é¢‘åµŒå…¥
- âš ï¸ æ²¡æœ‰è¡¨æ ¼æ”¯æŒ

### 2. é“¾æ¥ç‚¹å‡»å¤„ç†

**KnowledgeCardDisplay.vue:**
- âœ… é“¾æ¥æ‹¦æˆª
- âœ… æ¨¡æ€æ¡†å±•ç¤º
- âœ… iframeåµŒå…¥

### 3. å›¾ç‰‡æ˜¾ç¤º

**å½“å‰å®ç°:**
- âœ… åŸºç¡€imgæ ‡ç­¾æ”¯æŒ
- âœ… å“åº”å¼å°ºå¯¸
- âš ï¸ ç¼ºå°‘å›¾ç‰‡é¢„è§ˆ/æ”¾å¤§åŠŸèƒ½

## âŒ éœ€è¦å®ç°çš„åŠŸèƒ½

### 1. Markdownæ”¯æŒ

**åŸå› :** ç”¨æˆ·å¯èƒ½ä½¿ç”¨Markdownç¼–å†™å†…å®¹

**éœ€è¦:**
- æ ‡é¢˜ (h1-h6)
- åˆ—è¡¨ (æœ‰åº/æ— åº)
- å¼•ç”¨å—
- ä»£ç å—
- è¡¨æ ¼
- åˆ†éš”çº¿

### 2. ä»£ç é«˜äº®

**åŸå› :** æŠ€æœ¯ç±»è§†é¢‘éœ€è¦å±•ç¤ºä»£ç 

**éœ€è¦:**
- è¯­æ³•é«˜äº®
- è¡Œå·æ˜¾ç¤º
- ä»£ç å¤åˆ¶åŠŸèƒ½

### 3. æ•°å­¦å…¬å¼

**åŸå› :** æ•™è‚²ç±»è§†é¢‘éœ€è¦å±•ç¤ºå…¬å¼

**éœ€è¦:**
- LaTeXå…¬å¼æ¸²æŸ“
- è¡Œå†…å’Œå—çº§å…¬å¼

### 4. è§†é¢‘åµŒå…¥

**åŸå› :** çŸ¥è¯†å¡ç‰‡å¯èƒ½å¼•ç”¨å…¶ä»–è§†é¢‘ç‰‡æ®µ

**éœ€è¦:**
- YouTube/BilibiliåµŒå…¥
- æœ¬åœ°è§†é¢‘ç‰‡æ®µå¼•ç”¨

### 5. å›¾ç‰‡å¢å¼º

**éœ€è¦:**
- å›¾ç‰‡é¢„è§ˆ(lightbox)
- å›¾ç‰‡æ”¾å¤§åŠŸèƒ½
- å›¾ç‰‡æ‡’åŠ è½½
- å›¾ç‰‡æ ‡æ³¨

### 6. äº¤äº’å¼å†…å®¹

**éœ€è¦:**
- å¯æŠ˜å åŒºåŸŸ
- Tabé€‰é¡¹å¡
- æç¤ºæ¡†(tooltip)

## ğŸ”§ æ¨èçš„æ”¹è¿›æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: å¢å¼ºç‰ˆformatContentå‡½æ•°(æ¨è)

**ä¼˜ç‚¹:**
- æ— éœ€å¤–éƒ¨ä¾èµ–
- è½»é‡çº§
- å¯æ§æ€§å¼º

**å®ç°:**
```typescript
const formatContent = (content?: string): string => {
  if (!content) return '';
  
  let formatted = content;
  
  // 1. MarkdownåŸºç¡€è¯­æ³•è½¬æ¢
  // æ ‡é¢˜
  formatted = formatted.replace(/^### (.*$)/gm, '<h3>$1</h3>');
  formatted = formatted.replace(/^## (.*$)/gm, '<h2>$1</h2>');
  formatted = formatted.replace(/^# (.*$)/gm, '<h1>$1</h1>');
  
  // ç²—ä½“å’Œæ–œä½“
  formatted = formatted.replace(/\*\*\*(.+?)\*\*\*/g, '<strong><em>$1</em></strong>');
  formatted = formatted.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>');
  formatted = formatted.replace(/\*(.+?)\*/g, '<em>$1</em>');
  
  // åˆ—è¡¨
  formatted = formatted.replace(/^\- (.+)$/gm, '<li>$1</li>');
  formatted = formatted.replace(/(<li>.*<\/li>\n?)+/g, '<ul>$&</ul>');
  
  // å¼•ç”¨å—
  formatted = formatted.replace(/^> (.+)$/gm, '<blockquote>$1</blockquote>');
  
  // ä»£ç å—
  formatted = formatted.replace(/```(\w+)?\n([\s\S]+?)```/g, 
    '<pre><code class="language-$1">$2</code></pre>');
  
  // è¡Œå†…ä»£ç 
  formatted = formatted.replace(/`([^`]+)`/g, '<code>$1</code>');
  
  // é“¾æ¥ [text](url)
  formatted = formatted.replace(/\[([^\]]+)\]\(([^)]+)\)/g, 
    '<a href="$2" target="_blank" rel="noopener noreferrer" class="card-link">$1</a>');
  
  // å›¾ç‰‡ ![alt](url)
  formatted = formatted.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, 
    '<img src="$2" alt="$1" style="max-width: 100%; height: auto; border-radius: 8px; margin: 8px 0;" loading="lazy">');
  
  // 2. HTMLæ ‡ç­¾å¢å¼º
  formatted = formatted.replace(/<img(?![^>]*style=)/g, 
    '<img style="max-width: 100%; height: auto; border-radius: 8px; margin: 8px 0;" loading="lazy"');
  
  formatted = formatted.replace(/<a(?![^>]*target=)/g, 
    '<a target="_blank" rel="noopener noreferrer" class="card-link"');
  
  // 3. æ¢è¡Œå¤„ç†
  formatted = formatted.replace(/\n\n/g, '</p><p>');
  formatted = formatted.replace(/\n/g, '<br>');
  formatted = '<p>' + formatted + '</p>';
  
  return formatted;
};
```

### æ–¹æ¡ˆ2: ä½¿ç”¨markedåº“(Markdownæ¸²æŸ“)

**ä¼˜ç‚¹:**
- å®Œæ•´çš„Markdownæ”¯æŒ
- ç»è¿‡å……åˆ†æµ‹è¯•
- ç¤¾åŒºæ”¯æŒå¥½

**éœ€è¦:**
```bash
npm install marked
npm install highlight.js  # ä»£ç é«˜äº®
```

**å®ç°:**
```typescript
import { marked } from 'marked';
import hljs from 'highlight.js';

marked.setOptions({
  highlight: function(code, lang) {
    if (lang && hljs.getLanguage(lang)) {
      return hljs.highlight(code, { language: lang }).value;
    }
    return hljs.highlightAuto(code).value;
  }
});

const formatContent = (content?: string): string => {
  if (!content) return '';
  return marked(content);
};
```

### æ–¹æ¡ˆ3: ä½¿ç”¨vue-markdown-render(Vueä¸“ç”¨)

**ä¼˜ç‚¹:**
- Vue 3åŸç”Ÿæ”¯æŒ
- ç»„ä»¶åŒ–ä½¿ç”¨
- æ˜“äºé›†æˆ

**éœ€è¦:**
```bash
npm install vue-markdown-render
```

## ğŸ“ ç«‹å³å¯ä»¥æ”¹è¿›çš„ç‚¹

### 1. å¢å¼ºformatContentå‡½æ•°

ä¸éœ€è¦é¢å¤–ä¾èµ–,ç«‹å³å¯ä»¥æ”¹è¿›ã€‚

### 2. æ·»åŠ CSSæ ·å¼

```css
/* å¯Œæ–‡æœ¬å†…å®¹æ ·å¼ */
.content-wrapper h1,
.content-wrapper h2,
.content-wrapper h3 {
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  font-weight: 600;
  line-height: 1.3;
}

.content-wrapper h1 { font-size: 2em; }
.content-wrapper h2 { font-size: 1.5em; }
.content-wrapper h3 { font-size: 1.25em; }

.content-wrapper ul,
.content-wrapper ol {
  padding-left: 2em;
  margin: 1em 0;
}

.content-wrapper li {
  margin: 0.5em 0;
}

.content-wrapper blockquote {
  border-left: 4px solid #667eea;
  padding-left: 1em;
  margin: 1em 0;
  color: #666;
  font-style: italic;
  background: #f8f9ff;
  padding: 0.5em 1em;
  border-radius: 4px;
}

.content-wrapper code {
  background: #f5f5f5;
  padding: 2px 6px;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
  color: #d63384;
}

.content-wrapper pre {
  background: #282c34;
  color: #abb2bf;
  padding: 1em;
  border-radius: 6px;
  overflow-x: auto;
  margin: 1em 0;
}

.content-wrapper pre code {
  background: none;
  padding: 0;
  color: inherit;
  font-size: 0.9em;
}

.content-wrapper table {
  width: 100%;
  border-collapse: collapse;
  margin: 1em 0;
}

.content-wrapper th,
.content-wrapper td {
  border: 1px solid #ddd;
  padding: 8px 12px;
  text-align: left;
}

.content-wrapper th {
  background: #f8f9fa;
  font-weight: 600;
}

.content-wrapper img {
  cursor: zoom-in;
  transition: transform 0.2s;
}

.content-wrapper img:hover {
  transform: scale(1.02);
}
```

## ğŸ¯ æ¨èçš„å®æ–½æ­¥éª¤

### ç¬¬ä¸€é˜¶æ®µ: åŸºç¡€å¢å¼º(æ— éœ€ä¾èµ–)

1. âœ… å¢å¼ºformatContentå‡½æ•°æ”¯æŒMarkdownåŸºç¡€è¯­æ³•
2. âœ… æ·»åŠ å¯Œæ–‡æœ¬CSSæ ·å¼
3. âœ… ä¼˜åŒ–é“¾æ¥å¤„ç†(å·²å®ç°)
4. âœ… ä¼˜åŒ–å›¾ç‰‡å¤„ç†(å·²å®ç°)

### ç¬¬äºŒé˜¶æ®µ: åŠŸèƒ½æ‰©å±•(å¯é€‰ä¾èµ–)

1. æ·»åŠ ä»£ç é«˜äº®(highlight.js)
2. æ·»åŠ æ•°å­¦å…¬å¼æ¸²æŸ“(KaTeX)
3. æ·»åŠ å›¾ç‰‡é¢„è§ˆåŠŸèƒ½
4. æ·»åŠ è§†é¢‘åµŒå…¥æ”¯æŒ

### ç¬¬ä¸‰é˜¶æ®µ: é«˜çº§åŠŸèƒ½(å¯é€‰)

1. æ·»åŠ äº¤äº’å¼ç»„ä»¶
2. æ·»åŠ å†…å®¹æœç´¢åŠŸèƒ½
3. æ·»åŠ å†…å®¹å¯¼å‡ºåŠŸèƒ½

## ğŸ’¡ å»ºè®®

åŸºäºå½“å‰é¡¹ç›®æƒ…å†µ,å»ºè®®:

1. **ç«‹å³å®æ–½**: å¢å¼ºformatContentå‡½æ•°(æ–¹æ¡ˆ1)
   - æ— éœ€é¢å¤–ä¾èµ–
   - æ”¯æŒå¸¸ç”¨Markdownè¯­æ³•
   - ç»´æŠ¤ç®€å•

2. **çŸ­æœŸè§„åˆ’**: æ·»åŠ ä»£ç é«˜äº®
   - å¼•å…¥highlight.js
   - é€‚åˆæŠ€æœ¯ç±»è§†é¢‘

3. **é•¿æœŸè§„åˆ’**: è€ƒè™‘å®Œæ•´çš„Markdownè§£å†³æ–¹æ¡ˆ
   - æ ¹æ®ç”¨æˆ·åé¦ˆå†³å®š
   - å¯èƒ½å¼•å…¥markedåº“

## ğŸ“Œ æ€»ç»“

**å½“å‰çŠ¶æ€:**
- âœ… åŸºç¡€æ–‡å­—æ˜¾ç¤º
- âœ… åŸºç¡€å›¾ç‰‡æ˜¾ç¤º
- âœ… åŸºç¡€é“¾æ¥å¤„ç†
- âš ï¸ å¯Œæ–‡æœ¬æ ¼å¼æ”¯æŒä¸è¶³

**ç«‹å³å¯æ”¹è¿›:**
- å¢å¼ºMarkdownæ”¯æŒ
- ä¼˜åŒ–æ ·å¼å‘ˆç°
- æ— éœ€å¼•å…¥å¤–éƒ¨åº“

**éœ€è¦ç”¨æˆ·å†³ç­–:**
- æ˜¯å¦éœ€è¦ä»£ç é«˜äº®?
- æ˜¯å¦éœ€è¦æ•°å­¦å…¬å¼?
- æ˜¯å¦éœ€è¦è§†é¢‘åµŒå…¥?
