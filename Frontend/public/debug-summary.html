<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è§†é¢‘æ€»ç»“ç»„ä»¶è°ƒè¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    
    .debug-container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .debug-info {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .debug-info h2 {
      margin-bottom: 15px;
      color: #333;
    }
    
    .check-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .check-item:last-child {
      border-bottom: none;
    }
    
    .status {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      margin-right: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
    }
    
    .status.success {
      background: #28a745;
    }
    
    .status.error {
      background: #dc3545;
    }
    
    .status.warning {
      background: #ffc107;
      color: #333;
    }
    
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    
    button:hover {
      background: #0056b3;
    }
    
    .code-block {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      overflow-x: auto;
      margin: 10px 0;
    }
    
    .highlight {
      background: yellow;
      padding: 2px 5px;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div class="debug-container">
    <div class="debug-info">
      <h2>ğŸ” è§†é¢‘æ€»ç»“ç»„ä»¶æ˜¾ç¤ºé—®é¢˜è¯Šæ–­</h2>
      <p>è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ£€æŸ¥é—®é¢˜:</p>
    </div>
    
    <div class="debug-info">
      <h2>æ­¥éª¤ 1: æ£€æŸ¥ç»„ä»¶æ˜¯å¦å­˜åœ¨äº DOM</h2>
      <div class="check-item">
        <div class="status" id="dom-status">?</div>
        <div>
          <strong>æ£€æŸ¥ .video-summary-container å…ƒç´ </strong>
          <div id="dom-result"></div>
        </div>
      </div>
      <button onclick="checkDOM()">ğŸ” æ£€æŸ¥ DOM</button>
      <div class="code-block">
        document.querySelector('.video-summary-container')
      </div>
    </div>
    
    <div class="debug-info">
      <h2>æ­¥éª¤ 2: æ£€æŸ¥ currentVideo çŠ¶æ€</h2>
      <div class="check-item">
        <div class="status" id="video-status">?</div>
        <div>
          <strong>æ£€æŸ¥è§†é¢‘æ˜¯å¦å·²åŠ è½½</strong>
          <div id="video-result"></div>
        </div>
      </div>
      <button onclick="checkVideo()">ğŸ¬ æ£€æŸ¥è§†é¢‘çŠ¶æ€</button>
      <div class="code-block">
        document.querySelector('video')
      </div>
    </div>
    
    <div class="debug-info">
      <h2>æ­¥éª¤ 3: æ£€æŸ¥ CSS æ˜¾ç¤ºå±æ€§</h2>
      <div class="check-item">
        <div class="status" id="css-status">?</div>
        <div>
          <strong>æ£€æŸ¥ç»„ä»¶å¯è§æ€§</strong>
          <div id="css-result"></div>
        </div>
      </div>
      <button onclick="checkCSS()">ğŸ¨ æ£€æŸ¥ CSS</button>
      <div class="code-block">
        getComputedStyle(element).display
      </div>
    </div>
    
    <div class="debug-info">
      <h2>æ­¥éª¤ 4: æ£€æŸ¥æ»šåŠ¨ä½ç½®</h2>
      <div class="check-item">
        <div class="status" id="scroll-status">?</div>
        <div>
          <strong>æ£€æŸ¥æ˜¯å¦éœ€è¦æ»šåŠ¨</strong>
          <div id="scroll-result"></div>
        </div>
      </div>
      <button onclick="checkScroll()">ğŸ“œ æ£€æŸ¥æ»šåŠ¨</button>
      <button onclick="scrollToSummary()">â¬‡ï¸ æ»šåŠ¨åˆ°æ€»ç»“ç»„ä»¶</button>
    </div>
    
    <div class="debug-info">
      <h2>æ­¥éª¤ 5: å¼ºåˆ¶æ˜¾ç¤ºç»„ä»¶</h2>
      <button onclick="forceShow()">ğŸ’ª å¼ºåˆ¶æ˜¾ç¤ºç»„ä»¶</button>
      <button onclick="addTestComponent()">â• æ·»åŠ æµ‹è¯•ç»„ä»¶</button>
      <div class="code-block">
        ä¸´æ—¶ç§»é™¤ v-if æ¡ä»¶æˆ–ä¿®æ”¹ CSS
      </div>
    </div>
    
    <div class="debug-info">
      <h2>ğŸ“‹ è¯Šæ–­ç»“æœ</h2>
      <div id="diagnostic-result"></div>
    </div>
  </div>
  
  <script>
    function checkDOM() {
      const element = window.opener?.document.querySelector('.video-summary-container');
      const status = document.getElementById('dom-status');
      const result = document.getElementById('dom-result');
      
      if (element) {
        status.className = 'status success';
        status.textContent = 'âœ“';
        result.innerHTML = 'âœ… ç»„ä»¶å­˜åœ¨äº DOM ä¸­<br>ä½ç½®: ' + getElementPath(element);
      } else {
        status.className = 'status error';
        status.textContent = 'âœ—';
        result.innerHTML = 'âŒ ç»„ä»¶ä¸å­˜åœ¨äº DOM ä¸­<br><span class="highlight">å¯èƒ½åŸå› : v-if æ¡ä»¶æœªæ»¡è¶³æˆ–ç»„ä»¶æœªæ¸²æŸ“</span>';
      }
    }
    
    function checkVideo() {
      const video = window.opener?.document.querySelector('video');
      const status = document.getElementById('video-status');
      const result = document.getElementById('video-result');
      
      if (video && video.src) {
        status.className = 'status success';
        status.textContent = 'âœ“';
        result.innerHTML = `âœ… è§†é¢‘å·²åŠ è½½<br>URL: ${video.src}<br>æ—¶é•¿: ${video.duration} ç§’`;
      } else if (video) {
        status.className = 'status warning';
        status.textContent = '!';
        result.innerHTML = 'âš ï¸ è§†é¢‘å…ƒç´ å­˜åœ¨ä½†æœªåŠ è½½<br><span class="highlight">è¯·åŠ è½½ä¸€ä¸ªè§†é¢‘</span>';
      } else {
        status.className = 'status error';
        status.textContent = 'âœ—';
        result.innerHTML = 'âŒ è§†é¢‘å…ƒç´ ä¸å­˜åœ¨';
      }
    }
    
    function checkCSS() {
      const element = window.opener?.document.querySelector('.video-summary-container');
      const status = document.getElementById('css-status');
      const result = document.getElementById('css-result');
      
      if (!element) {
        status.className = 'status error';
        status.textContent = 'âœ—';
        result.innerHTML = 'âŒ ç»„ä»¶ä¸å­˜åœ¨,æ— æ³•æ£€æŸ¥ CSS';
        return;
      }
      
      const styles = window.opener?.getComputedStyle(element);
      const display = styles.display;
      const visibility = styles.visibility;
      const opacity = styles.opacity;
      const height = styles.height;
      
      if (display === 'none') {
        status.className = 'status error';
        status.textContent = 'âœ—';
        result.innerHTML = 'âŒ display: none<br><span class="highlight">ç»„ä»¶è¢«éšè—äº†!</span>';
      } else if (visibility === 'hidden') {
        status.className = 'status error';
        status.textContent = 'âœ—';
        result.innerHTML = 'âŒ visibility: hidden';
      } else if (opacity === '0') {
        status.className = 'status warning';
        status.textContent = '!';
        result.innerHTML = 'âš ï¸ opacity: 0';
      } else {
        status.className = 'status success';
        status.textContent = 'âœ“';
        result.innerHTML = `âœ… CSS æ­£å¸¸<br>display: ${display}<br>visibility: ${visibility}<br>opacity: ${opacity}<br>height: ${height}`;
      }
    }
    
    function checkScroll() {
      const element = window.opener?.document.querySelector('.video-summary-container');
      const main = window.opener?.document.querySelector('.video-main');
      const status = document.getElementById('scroll-status');
      const result = document.getElementById('scroll-result');
      
      if (!element) {
        status.className = 'status error';
        status.textContent = 'âœ—';
        result.innerHTML = 'âŒ ç»„ä»¶ä¸å­˜åœ¨';
        return;
      }
      
      const rect = element.getBoundingClientRect();
      const windowHeight = window.opener?.innerHeight || 0;
      const isVisible = rect.top < windowHeight && rect.bottom > 0;
      
      if (isVisible) {
        status.className = 'status success';
        status.textContent = 'âœ“';
        result.innerHTML = 'âœ… ç»„ä»¶åœ¨å¯è§åŒºåŸŸå†…';
      } else {
        status.className = 'status warning';
        status.textContent = '!';
        result.innerHTML = `âš ï¸ ç»„ä»¶åœ¨å¯è§åŒºåŸŸå¤–<br>è·ç¦»é¡¶éƒ¨: ${Math.round(rect.top)}px<br><span class="highlight">éœ€è¦æ»šåŠ¨æ‰èƒ½çœ‹åˆ°</span>`;
      }
      
      if (main) {
        result.innerHTML += `<br>å®¹å™¨æ»šåŠ¨é«˜åº¦: ${main.scrollHeight}px<br>å®¹å™¨å¯è§é«˜åº¦: ${main.clientHeight}px`;
      }
    }
    
    function scrollToSummary() {
      const element = window.opener?.document.querySelector('.video-summary-container');
      if (element) {
        element.scrollIntoView({ behavior: 'smooth', block: 'start' });
        alert('å·²æ»šåŠ¨åˆ°æ€»ç»“ç»„ä»¶ä½ç½®');
      } else {
        alert('âŒ æ‰¾ä¸åˆ°ç»„ä»¶');
      }
    }
    
    function forceShow() {
      const element = window.opener?.document.querySelector('.video-summary-container');
      if (element) {
        element.style.display = 'block';
        element.style.visibility = 'visible';
        element.style.opacity = '1';
        element.style.position = 'relative';
        element.style.zIndex = '9999';
        alert('âœ… å·²å¼ºåˆ¶æ˜¾ç¤ºç»„ä»¶');
      } else {
        alert('âŒ æ‰¾ä¸åˆ°ç»„ä»¶');
      }
    }
    
    function addTestComponent() {
      const main = window.opener?.document.querySelector('.video-main');
      if (main) {
        const test = window.opener?.document.createElement('div');
        test.style.cssText = 'background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; margin: 20px 0; border-radius: 12px; text-align: center; font-size: 24px; font-weight: bold;';
        test.textContent = 'ğŸ§ª æµ‹è¯•ç»„ä»¶ - å¦‚æœä½ èƒ½çœ‹åˆ°è¿™ä¸ª,è¯´æ˜ç»„ä»¶å¯ä»¥æ˜¾ç¤º';
        main.appendChild(test);
        test.scrollIntoView({ behavior: 'smooth' });
        alert('âœ… å·²æ·»åŠ æµ‹è¯•ç»„ä»¶');
      } else {
        alert('âŒ æ‰¾ä¸åˆ° .video-main å®¹å™¨');
      }
    }
    
    function getElementPath(element) {
      const path = [];
      while (element) {
        let selector = element.tagName.toLowerCase();
        if (element.id) {
          selector += '#' + element.id;
        } else if (element.className) {
          selector += '.' + element.className.split(' ').join('.');
        }
        path.unshift(selector);
        element = element.parentElement;
        if (path.length > 5) break;
      }
      return path.join(' > ');
    }
    
    // è‡ªåŠ¨è¿è¡Œæ£€æŸ¥
    window.addEventListener('load', () => {
      setTimeout(() => {
        if (window.opener) {
          alert('âœ… è°ƒè¯•å·¥å…·å·²åŠ è½½!\n\nè¯·ç‚¹å‡»å„ä¸ªæŒ‰é’®æ£€æŸ¥é—®é¢˜ã€‚');
        } else {
          alert('âš ï¸ è¯·ä»ä¸»é¡µé¢æ‰“å¼€æ­¤è°ƒè¯•å·¥å…·!\n\nåœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œ:\nwindow.open("/debug.html")');
        }
      }, 500);
    });
  </script>
</body>
</html>
