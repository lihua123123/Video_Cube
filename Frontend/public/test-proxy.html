<!DOCTYPE html>
<html>
<head>
    <title>å›¾ç‰‡ä»£ç†æµ‹è¯•</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        img {
            max-width: 400px;
            border: 2px solid #667eea;
            border-radius: 8px;
            margin: 10px 0;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        code {
            background: #e0e0e0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸ” å›¾ç‰‡ä»£ç†è°ƒè¯•é¡µé¢</h1>
    
    <div class="test-section">
        <h2>æµ‹è¯•1: ç›´æ¥è®¿é—®åç«¯ (ç»•è¿‡Viteä»£ç†)</h2>
        <p>URL: <code>http://localhost:3000/uploads/images/ed3e8a84-bacf-4cac-a8f7-8753c98abcc7.png</code></p>
        <img 
            id="direct-backend" 
            src="http://localhost:3000/uploads/images/ed3e8a84-bacf-4cac-a8f7-8753c98abcc7.png"
            alt="ç›´æ¥è®¿é—®åç«¯"
        />
        <div id="direct-status"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•2: é€šè¿‡Viteä»£ç†è®¿é—®</h2>
        <p>URL: <code>/uploads/images/ed3e8a84-bacf-4cac-a8f7-8753c98abcc7.png</code></p>
        <img 
            id="proxy-access" 
            src="/uploads/images/ed3e8a84-bacf-4cac-a8f7-8753c98abcc7.png"
            alt="é€šè¿‡ä»£ç†è®¿é—®"
        />
        <div id="proxy-status"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯•3: Fetch APIæµ‹è¯•ä»£ç†</h2>
        <button onclick="testFetch()" style="padding: 10px 20px; font-size: 16px; cursor: pointer;">
            æµ‹è¯• Fetch è¯·æ±‚
        </button>
        <div id="fetch-result" style="margin-top: 10px;"></div>
    </div>

    <script>
        const directImg = document.getElementById('direct-backend');
        const proxyImg = document.getElementById('proxy-access');

        directImg.onload = function() {
            document.getElementById('direct-status').innerHTML = 
                `<p class="success">âœ“ ç›´æ¥è®¿é—®åç«¯æˆåŠŸ! (${this.naturalWidth}x${this.naturalHeight})</p>`;
        };

        directImg.onerror = function() {
            document.getElementById('direct-status').innerHTML = 
                '<p class="error">âœ— ç›´æ¥è®¿é—®åç«¯å¤±è´¥! åç«¯æœåŠ¡å™¨å¯èƒ½æ²¡æœ‰è¿è¡Œ</p>';
        };

        proxyImg.onload = function() {
            document.getElementById('proxy-status').innerHTML = 
                `<p class="success">âœ“ Viteä»£ç†å·¥ä½œæ­£å¸¸! (${this.naturalWidth}x${this.naturalHeight})</p>`;
        };

        proxyImg.onerror = function() {
            document.getElementById('proxy-status').innerHTML = 
                '<p class="error">âœ— Viteä»£ç†å¤±è´¥! è¯·æ£€æŸ¥vite.config.tsé…ç½®</p>';
        };

        async function testFetch() {
            const resultDiv = document.getElementById('fetch-result');
            resultDiv.innerHTML = '<p>æµ‹è¯•ä¸­...</p>';

            try {
                const response = await fetch('/uploads/images/ed3e8a84-bacf-4cac-a8f7-8753c98abcc7.png');
                
                if (response.ok) {
                    const blob = await response.blob();
                    resultDiv.innerHTML = `
                        <p class="success">âœ“ FetchæˆåŠŸ!</p>
                        <p>çŠ¶æ€ç : ${response.status}</p>
                        <p>Content-Type: ${response.headers.get('content-type')}</p>
                        <p>æ–‡ä»¶å¤§å°: ${blob.size} bytes</p>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <p class="error">âœ— Fetchå¤±è´¥!</p>
                        <p>çŠ¶æ€ç : ${response.status}</p>
                        <p>çŠ¶æ€æ–‡æœ¬: ${response.statusText}</p>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <p class="error">âœ— Fetché”™è¯¯!</p>
                    <p>é”™è¯¯ä¿¡æ¯: ${error.message}</p>
                `;
            }
        }
    </script>
</body>
</html>
